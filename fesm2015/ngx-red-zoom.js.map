{"version":3,"file":"ngx-red-zoom.js","sources":["../../../projects/ngx-red-zoom/src/lib/red-zoom-template.class.ts","../../../projects/ngx-red-zoom/src/lib/red-zoom-image.class.ts","../../../projects/ngx-red-zoom/src/lib/vector.ts","../../../projects/ngx-red-zoom/src/lib/red-zoom.directive.ts","../../../projects/ngx-red-zoom/src/lib/red-zoom.module.ts","../../../../projects/ngx-red-zoom/src/public-api.ts","../../../../projects/ngx-red-zoom/src/ngx-red-zoom.ts"],"sourcesContent":["import { RedZoomStatus } from './red-zoom-status.type';\n\n\nconst makeTemplate = (() => {\n    let template: HTMLTemplateElement = null;\n\n    return () => {\n        if (!template) {\n            template = document.createElement('template');\n            template.innerHTML = `<div class=\"red-zoom\">\n                <div class=\"red-zoom__overlay\"></div>\n                <div class=\"red-zoom__frame\">\n                    <div class=\"red-zoom__frame-body\"></div>\n                </div>\n                <div class=\"red-zoom__lens\">\n                    <div class=\"red-zoom__lens-body\"></div>\n                </div>\n                <div class=\"red-zoom__error\">\n                    <div class=\"red-zoom__error-message\"></div>\n                </div>\n            </div>`;\n        }\n\n        return template.content.cloneNode(true).firstChild as HTMLDivElement;\n    };\n})();\n\n\nexport class RedZoomTemplate {\n    _status: RedZoomStatus = null;\n\n    template: HTMLDivElement;\n    lens: HTMLDivElement;\n    lensBody: HTMLDivElement;\n    frame: HTMLDivElement;\n    frameBody: HTMLDivElement;\n    error: HTMLDivElement;\n    errorMessage: HTMLDivElement;\n\n    private appliedClasses: string[] = [];\n\n    constructor() {\n        this.template = makeTemplate();\n        this.lens = this.template.querySelector('.red-zoom__lens');\n        this.lensBody = this.template.querySelector('.red-zoom__lens-body');\n        this.frame = this.template.querySelector('.red-zoom__frame');\n        this.frameBody = this.template.querySelector('.red-zoom__frame-body');\n        this.error = this.template.querySelector('.red-zoom__error');\n        this.errorMessage = this.template.querySelector('.red-zoom__error-message');\n\n        this.template.addEventListener('transitionend', this.onTransitionEnd);\n        this.status = 'loading';\n    }\n\n    set status(state: RedZoomStatus) {\n        if (this._status !== null) {\n            this.template.classList.remove(`red-zoom--status--${this._status}`);\n        }\n\n        this._status = state;\n        this.template.classList.add(`red-zoom--status--${state}`);\n    }\n\n    get status(): RedZoomStatus {\n        return this._status;\n    }\n\n    set classes(classes: string) {\n        this.template.classList.remove(...this.appliedClasses);\n\n        classes = classes.trim();\n\n        if (classes) {\n            this.appliedClasses = classes.replace(/ +/, ' ').split(' ');\n            this.template.classList.add(...this.appliedClasses);\n        }\n    }\n\n    get isHidden(): boolean {\n        return getComputedStyle(this.template).visibility === 'hidden';\n    }\n\n    setProperties(properties: {[name: string]: string}): void {\n        for (let name in properties) {\n            this.template.style.setProperty(name, properties[name]);\n        }\n    }\n\n    detach(): void {\n        this.template.classList.remove('red-zoom--active');\n\n        if (this.isHidden) {\n            this.template.remove();\n        }\n    }\n\n    attach(): void {\n        if (this.template.parentNode !== document.body) {\n            document.body.appendChild(this.template);\n        }\n    }\n\n    activate(): void {\n        this.template.classList.add('red-zoom--active');\n    }\n\n    onTransitionEnd = (event: TransitionEvent) => {\n        if (event.propertyName === 'visibility' && this.isHidden) {\n            this.template.remove();\n        }\n    };\n}\n","import { RedZoomStatus } from './red-zoom-status.type';\nimport * as vector from './vector';\n\n\nexport class RedZoomImage {\n    private loading = false;\n\n    isFirst = true;\n\n    get width(): number {\n        return this.element.width;\n    }\n\n    get height(): number {\n        return this.element.height;\n    }\n\n    get size(): vector.VectorNumber {\n        return {x: this.width, y: this.height};\n    }\n\n    get naturalWidth(): number {\n        return this.element.naturalWidth;\n    }\n\n    get naturalHeight(): number {\n        return this.element.naturalHeight;\n    }\n\n    get naturalSize(): vector.VectorNumber {\n        return {x: this.naturalWidth, y: this.naturalHeight};\n    }\n\n    get style(): CSSStyleDeclaration {\n        return this.element.style;\n    }\n\n    set styleSize(value: vector.VectorString) {\n        this.element.style.width = value.x;\n        this.element.style.height = value.y;\n    }\n\n    get status(): RedZoomStatus {\n        if (this.loading) {\n            return 'loading';\n        }\n\n        if (this.element.complete) {\n            if (!this.element.src) {\n                return 'loading';\n            } else if (this.naturalWidth === 0) {\n                return 'error';\n            }\n\n            return 'loaded';\n        }\n\n        return 'loading';\n    }\n\n    set src(value: string) {\n        this.loading = false;\n        this.element.setAttribute('src', value);\n    }\n\n    constructor(\n        public element: HTMLImageElement = null,\n        public listener: () => void = () => {},\n        className: string = null,\n    ) {\n        if (element === null) {\n            this.element = document.createElement('img');\n        }\n\n        const _listener = () => {\n            if (this.status !== 'loading') {\n                this.isFirst = false;\n            }\n\n            this.listener();\n        };\n\n        this.element.addEventListener('load', _listener);\n        this.element.addEventListener('error', _listener);\n\n        this.destroy = () => {\n            this.element.removeEventListener('load', _listener);\n            this.element.removeEventListener('error', _listener);\n        };\n\n        if (className !== null) {\n            this.element.classList.add(className);\n        }\n    }\n\n    reset(): void {\n        this.loading = true;\n        this.listener();\n    }\n\n    destroy: () => void;\n}\n","type Operator = '+'|'-'|'*'|'/'|'min'|'max';\n\nfunction calc(a: number, op: Operator, b: number) {\n    switch (op) {\n        case '+': return a + b;\n        case '-': return a - b;\n        case '*': return a * b;\n        case '/': return a / b;\n        case 'min': return Math.min(a, b);\n        case 'max': return Math.max(a, b);\n    }\n}\n\nexport interface Vector<T> {\n    x: T,\n    y: T,\n}\n\nexport type VectorNumber = Vector<number>;\n\nexport type VectorString = Vector<string>;\n\nexport type VectorBoolean = Vector<boolean>;\n\nexport function fromRectPos(rect: ClientRect): VectorNumber {\n    return {x: rect.left, y: rect.top};\n}\n\nexport function fromRectSize(rect: ClientRect): VectorNumber {\n    return {x: rect.width, y: rect.height};\n}\n\nexport function fromScroll(): VectorNumber {\n    return {x: scrollX, y: scrollY};\n}\n\nexport function fromMouseEvent(event: MouseEvent): VectorNumber {\n    return add({x: event.clientX, y: event.clientY}, fromScroll());\n}\n\nexport function op(a: VectorNumber, op: Operator, b: VectorNumber | number): VectorNumber {\n    if (typeof b === 'number') {\n        b = {x: b, y: b};\n    }\n\n    return {\n        x: calc(a.x, op, b.x),\n        y: calc(a.y, op, b.y)\n    };\n}\n\nexport function add(a: VectorNumber, b: VectorNumber | number): VectorNumber {\n    return op(a, '+', b);\n}\n\nexport function sub(a: VectorNumber, b: VectorNumber | number): VectorNumber {\n    return op(a, '-', b);\n}\n\nexport function mul(a: VectorNumber, b: VectorNumber | number): VectorNumber {\n    return op(a, '*', b);\n}\n\nexport function div(a: VectorNumber, b: VectorNumber | number): VectorNumber {\n    return op(a, '/', b);\n}\n\nexport function min(a: VectorNumber, b: VectorNumber | number): VectorNumber {\n    return op(a, 'min', b);\n}\n\nexport function max(a: VectorNumber, b: VectorNumber | number): VectorNumber {\n    return op(a, 'max', b);\n}\n\nexport function round(a: VectorNumber): VectorNumber {\n    return map(a, Math.round);\n}\n\nexport function map<T, B>(a: Vector<T>, fn: (c: T, axis: 'x'|'y') => B): Vector<B> {\n    return {x: fn(a.x, 'x'), y: fn(a.y, 'y')};\n}\n\nexport function equal(a: VectorNumber, b: VectorNumber | number): VectorBoolean {\n    if (typeof b === 'number') {\n        b = {x: b, y: b};\n    }\n\n    return {\n        x: a.x === b.x,\n        y: a.y === b.y,\n    };\n}\n\nexport function notEqual(a: VectorNumber, b: VectorNumber): VectorBoolean {\n    return {x: a.x !== b.x, y: a.y !== b.y};\n}\n\nexport function flatMax(a: VectorNumber): number {\n    return Math.max(a.x, a.y);\n}\n\nexport function flatMin(a: VectorNumber): number {\n    return Math.min(a.x, a.y);\n}\n\nexport function flatOr(a: VectorBoolean): boolean {\n    return a.x || a.y;\n}\n","import {\n    AfterContentInit,\n    Directive,\n    ElementRef,\n    Inject,\n    Input,\n    NgZone,\n    Renderer2,\n    OnChanges,\n    SimpleChanges,\n    HostBinding, OnDestroy, PLATFORM_ID\n} from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { RedZoomTemplate } from './red-zoom-template.class';\nimport { RedZoomStatus } from './red-zoom-status.type';\nimport { RedZoomImage } from './red-zoom-image.class';\nimport * as vector from './vector';\nimport { VectorNumber } from './vector';\n\n\ninterface Session {\n    active: boolean;\n    thumbSize: vector.VectorNumber;\n    thumbPos: vector.VectorNumber;\n    lensContainerSize: vector.VectorNumber;\n    lensImageSize: vector.VectorNumber;\n    frameSize: vector.VectorNumber;\n    mousePos: vector.VectorNumber;\n    destroy: () => void;\n}\n\n\n@Directive({\n    selector: '[redZoom]',\n    exportAs: 'redZoom',\n})\nexport class RedZoomDirective implements AfterContentInit, OnChanges, OnDestroy {\n    @Input('src') @HostBinding('attr.src') src: string;\n\n    @Input('redZoom') lensSrc: string;\n\n    @Input('redZoomThumb') thumbSrc: string;\n\n    @Input('redZoomLazy') lazy: boolean = false;\n\n    @Input('redZoomClass') classes: string = '';\n\n    @Input('redZoomBehavior') behavior: 'hover' | 'grab' | 'click' = 'hover';\n\n    @Input('redZoomMouseWheel') wheel: boolean = true;\n\n    @Input() minScaleFactor: number;\n\n    @Input() maxScaleFactor: number;\n\n    @Input('redZoomErrorMessage') errorMessage: string = 'An error occurred while loading the image.';\n\n    template: RedZoomTemplate;\n    thumbImage: RedZoomImage;\n    frameImage: RedZoomImage;\n    lensImage: RedZoomImage;\n    scaleFactor = 1;\n    session: Session;\n    requestAnimationFrameId = null;\n\n    get isImage(): boolean {\n        return this.element.nativeElement.tagName === 'IMG';\n    }\n\n    get status(): RedZoomStatus {\n        let status: RedZoomStatus = 'loaded';\n        const images = [this.frameImage, this.lensImage];\n\n        if (this.isImage) {\n            images.push(this.thumbImage);\n        }\n\n        for (let image of images) {\n            if (status === 'error' || image.status === 'error') {\n                status = 'error';\n            } else if (status === 'loading' || image.status === 'loading') {\n                status = 'loading';\n            }\n        }\n\n        return status;\n    }\n\n    constructor(\n        private element: ElementRef,\n        private renderer: Renderer2,\n        private zone: NgZone,\n        @Inject(PLATFORM_ID) private platformId: string,\n    ) { }\n\n    listen(): void {\n        const startEventName = {\n            'hover': 'mouseenter',\n            'grab': 'mousedown',\n            'click': 'mousedown',\n        }[this.behavior];\n\n        this.unlisten();\n        this.unlisten = this.renderer.listen(this.element.nativeElement, startEventName, this.mouseEnter);\n    }\n\n    unlisten: () => void  = () => {};\n\n    onImageChangeStatus = (() => {\n        let previousStatus;\n\n        return () => {\n            if (previousStatus === this.status) {\n                return;\n            }\n\n            previousStatus = this.status;\n\n            this.onImageChangeStatusDistinct();\n        };\n    })();\n\n    onImageChangeStatusDistinct = () => {\n        this.template.status = this.status;\n\n        if (this.status === 'loaded') {\n            this.template.setProperties({\n                '--red-zoom-lens-image-natural-w': `${this.lensImage.naturalWidth}px`,\n                '--red-zoom-lens-image-natural-h': `${this.lensImage.naturalHeight}px`,\n            });\n\n            if (this.session && this.session.active) {\n                this.calcScaleFactor();\n                this.calcFrameSize();\n                this.move();\n\n                this.scaleFactor = this.lensImage.width / this.lensImage.naturalWidth;\n            }\n        }\n    };\n\n    ngAfterContentInit(): void {\n        if (!isPlatformBrowser(this.platformId)) {\n            return;\n        }\n\n        this.zone.runOutsideAngular(() => {\n            this.template = new RedZoomTemplate();\n            this.template.classes = this.classes;\n            this.template.errorMessage.innerHTML = this.errorMessage;\n\n            if (this.isImage) {\n                this.thumbImage = new RedZoomImage(this.element.nativeElement, this.onImageChangeStatus);\n            }\n\n            this.frameImage = new RedZoomImage(null, this.onImageChangeStatus, 'red-zoom__frame-image');\n            this.lensImage = new RedZoomImage(null, this.onImageChangeStatus, 'red-zoom__lens-image');\n\n            if (!this.lazy) {\n                this.loadFrameImage();\n                this.loadLensImage();\n            }\n\n            this.listen();\n        });\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if (!isPlatformBrowser(this.platformId)) {\n            return;\n        }\n\n        if ('src' in changes && !changes.src.firstChange) {\n            this.onChangeThumbSrc();\n        }\n        if ('thumbSrc' in changes && !changes.thumbSrc.firstChange) {\n            this.onChangeThumbSrc();\n        }\n        if ('lensSrc' in changes && !changes.lensSrc.firstChange) {\n            this.onChangeLensSrc();\n        }\n        if ('behavior' in changes && !changes.behavior.firstChange) {\n            this.listen();\n        }\n        if ('classes' in changes && !changes.classes.firstChange) {\n            this.template.classes = this.classes;\n            this.invalidate();\n        }\n        if ('errorMessage' in changes && !changes.errorMessage.firstChange) {\n            this.template.errorMessage.innerHTML = this.errorMessage;\n        }\n    }\n\n    ngOnDestroy(): void {\n        if (!isPlatformBrowser(this.platformId)) {\n            return;\n        }\n\n        if (this.session) {\n            this.session.destroy();\n        }\n    }\n\n    onChangeThumbSrc(): void {\n        this.frameImage.reset();\n\n        if (!this.lazy || this.session) {\n            this.loadFrameImage();\n        }\n    }\n\n    onChangeLensSrc(): void {\n        this.lensImage.reset();\n\n        if (!this.lazy || this.session) {\n            this.loadLensImage();\n        }\n    }\n\n    getThumbSrc(): string {\n        if (!this.isImage || !this.src) {\n            return this.thumbSrc;\n        }\n\n        return this.src;\n    }\n\n    loadLensImage() {\n        if (this.lensImage.status !== 'loaded') {\n            this.lensImage.src = this.lensSrc;\n        }\n    }\n\n    loadFrameImage() {\n        if (this.frameImage.status !== 'loaded') {\n            this.frameImage.src = this.getThumbSrc();\n        }\n    }\n\n    mouseEnter = (event: MouseEvent) => {\n        if (event.cancelable) {\n            event.preventDefault();\n        }\n\n        if (this.session) {\n            this.session.destroy();\n        }\n\n        this.session = {\n            active: false,\n            thumbSize: null,\n            thumbPos: null,\n            lensContainerSize: null,\n            lensImageSize: null,\n            frameSize: null,\n            mousePos: vector.fromMouseEvent(event),\n            destroy: () => {},\n        };\n\n        const onWheel = (wheelEvent: WheelEvent) => {\n            if (!wheelEvent.cancelable || this.status !== 'loaded' || !this.wheel) {\n                return;\n            }\n\n            wheelEvent.preventDefault();\n\n            const delta = Math.sign(wheelEvent.deltaY);\n            const nextScaleFactor = this.scaleFactor + .01 * -delta;\n\n            console.log(nextScaleFactor);\n\n            if (this.minScaleFactor !== undefined && nextScaleFactor < this.minScaleFactor) {\n                return;\n            }\n            if (this.maxScaleFactor !== undefined && nextScaleFactor > this.maxScaleFactor) {\n                return;\n            }\n\n            this.scaleFactor += .01 * -delta;\n\n            this.calcScaleFactor();\n            this.calcFrameSize();\n            this.onMouseMove(\n                this.behavior === 'click' ? this.session.mousePos : vector.fromMouseEvent(wheelEvent),\n            );\n        };\n\n        const onMove = (mouseEvent: MouseEvent) => {\n            this.onMouseMove(vector.fromMouseEvent(mouseEvent));\n        };\n        const onLeave = () => {\n            this.session = null;\n            this.template.detach();\n\n            unListenMove();\n            unListenLeave();\n            unListenWheel();\n        };\n\n        let unListenMove;\n        let unListenLeave;\n        let unListenWheel;\n\n        if (this.behavior === 'hover') {\n            unListenMove = this.renderer.listen(this.element.nativeElement, 'mousemove', onMove);\n            unListenLeave = this.renderer.listen(this.element.nativeElement, 'mouseleave', onLeave);\n        } else if (this.behavior === 'click') {\n            unListenMove = () => {};\n            unListenLeave = this.renderer.listen(document, 'mousedown', (event) => {\n                const element = this.element.nativeElement as HTMLElement;\n\n                if (!element.contains(event.target)) {\n                    onLeave();\n                }\n            });\n        } else {\n            unListenMove = this.renderer.listen(document, 'mousemove', onMove);\n            unListenLeave = this.renderer.listen(document, 'mouseup', onLeave);\n        }\n\n        unListenWheel = this.renderer.listen(this.element.nativeElement, 'wheel', onWheel);\n\n        this.onMouseMove(vector.fromMouseEvent(event));\n\n        this.forceReflow();\n        this.template.activate();\n\n        if (this.status !== 'loaded') {\n            this.loadLensImage();\n            this.loadFrameImage();\n        }\n\n        this.session.destroy = onLeave;\n    };\n\n    onMouseMove = (mousePos: VectorNumber) => {\n        if (this.isImage && this.thumbImage.status !== 'loaded' && this.thumbImage.isFirst) {\n            return;\n        }\n\n        if (!this.session.active) {\n            this.session.active = true;\n            this.initSession();\n        }\n\n        this.session.mousePos = mousePos;\n\n        if (this.status === 'loaded') {\n            cancelAnimationFrame(this.requestAnimationFrameId);\n\n            this.requestAnimationFrameId = requestAnimationFrame(() => this.move());\n        }\n    };\n\n    initSession(): void {\n        const thumbRect = this.element.nativeElement.getBoundingClientRect();\n\n        this.session.thumbSize = vector.fromRectSize(thumbRect);\n        this.session.thumbPos = vector.add(vector.fromRectPos(thumbRect), vector.fromScroll());\n\n        this.template.attach();\n        this.template.lensBody.appendChild(this.lensImage.element);\n        this.template.frameBody.appendChild(this.frameImage.element);\n\n        this.template.setProperties({\n            '--red-zoom-thumb-x': `${this.session.thumbPos.x}px`,\n            '--red-zoom-thumb-y': `${this.session.thumbPos.y}px`,\n            '--red-zoom-thumb-w': `${this.session.thumbSize.x}px`,\n            '--red-zoom-thumb-h': `${this.session.thumbSize.y}px`,\n            '--red-zoom-thumb-size-max': `${vector.flatMax(this.session.thumbSize)}px`,\n            '--red-zoom-thumb-size-min': `${vector.flatMin(this.session.thumbSize)}px`,\n        });\n\n        if (this.status === 'loaded') {\n            this.calcScaleFactor();\n            this.calcFrameSize();\n\n            this.scaleFactor = this.lensImage.width / this.lensImage.naturalWidth;\n        }\n    }\n\n    calcScaleFactor(): void {\n        const scaledSize = vector.mul(this.lensImage.naturalSize, this.scaleFactor);\n\n        this.lensImage.styleSize = vector.map(scaledSize, c => `${c}px`);\n\n        const scaleFactorIsLimited = vector.flatOr(\n            vector.notEqual(this.lensImage.size, vector.round(scaledSize))\n        );\n\n        if (scaleFactorIsLimited) {\n            this.scaleFactor = vector.flatMax(vector.div(this.lensImage.size, this.lensImage.naturalSize));\n\n            this.lensImage.styleSize = vector.map(vector.mul(this.lensImage.naturalSize, this.scaleFactor), c => `${c}px`);\n        }\n    }\n\n    calcFrameSize(): void {\n        this.session.lensContainerSize = vector.fromRectSize(this.template.lensBody.getBoundingClientRect());\n        this.session.lensImageSize = vector.fromRectSize(this.lensImage.element.getBoundingClientRect());\n\n        this.session.frameSize = vector.min(\n            this.session.thumbSize,\n            vector.round(\n                vector.mul(\n                    this.session.thumbSize, vector.div(this.session.lensContainerSize, this.session.lensImageSize)\n                )\n            )\n        );\n\n        this.template.setProperties({\n            '--red-zoom-frame-w': `${this.session.frameSize.x}px`,\n            '--red-zoom-frame-h': `${this.session.frameSize.y}px`,\n        });\n    }\n\n    move(): void {\n        if (!this.session || !this.session.active) {\n            return;\n        }\n\n        const { mousePos, thumbSize, thumbPos, frameSize, lensContainerSize, lensImageSize } = this.session;\n\n        this.template.setProperties({\n            '--red-zoom-mouse-x': `${mousePos.x}px`,\n            '--red-zoom-mouse-y': `${mousePos.y}px`,\n        });\n\n        const framePos = vector.sub(mousePos, vector.div(frameSize, 2));\n        const frameLimitedPos = vector.min(\n            vector.max(framePos, thumbPos),\n            vector.sub(vector.add(thumbPos, thumbSize), frameSize),\n        );\n        const frameImagePos = vector.sub(thumbPos, vector.round(frameLimitedPos));\n\n        this.template.setProperties({\n            '--red-zoom-frame-x': `${Math.round(frameLimitedPos.x)}px`,\n            '--red-zoom-frame-y': `${Math.round(frameLimitedPos.y)}px`,\n            '--red-zoom-frame-image-x': `${Math.round(frameImagePos.x)}px`,\n            '--red-zoom-frame-image-y': `${Math.round(frameImagePos.y)}px`,\n        });\n\n        const frameRelativePos = vector.map(vector.sub(thumbSize, frameSize), (value, axis) => {\n            return value === 0 ? 0 : (frameLimitedPos[axis] - thumbPos[axis]) / value;\n        });\n        const lensImagePos = vector.mul(\n            frameRelativePos,\n            vector.sub(lensImageSize, lensContainerSize)\n        );\n        const lensImageCenterOffset = vector.max(vector.div(vector.sub(lensContainerSize, lensImageSize), 2), 0);\n        const lensImageFrameOffset = vector.mul(\n            vector.div(vector.sub(framePos, frameLimitedPos), vector.div(frameSize, 2)),\n            vector.div(lensContainerSize, 2)\n        );\n\n        this.template.setProperties({\n            '--red-zoom-lens-image-base-x': `${-lensImagePos.x}px`,\n            '--red-zoom-lens-image-base-y': `${-lensImagePos.y}px`,\n            '--red-zoom-lens-image-center-offset-x': `${lensImageCenterOffset.x}px`,\n            '--red-zoom-lens-image-center-offset-y': `${lensImageCenterOffset.y}px`,\n            '--red-zoom-lens-image-frame-offset-x': `${-lensImageFrameOffset.x}px`,\n            '--red-zoom-lens-image-frame-offset-y': `${-lensImageFrameOffset.y}px`,\n        });\n    }\n\n    invalidate() {\n        if (this.session && this.session.active) {\n            this.initSession();\n            this.move();\n        }\n    }\n\n    forceReflow(): void {\n        this.element.nativeElement.getBoundingClientRect();\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { RedZoomDirective } from './red-zoom.directive';\n\n\n@NgModule({\n    declarations: [\n        RedZoomDirective\n    ],\n    exports: [\n        RedZoomDirective\n    ]\n})\nexport class RedZoomModule { }\n","/*\n * Public API Surface of ngx-red-zoom\n */\n\nexport * from './lib/red-zoom.module';\nexport { RedZoomDirective } from './lib/red-zoom.directive';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["vector.fromMouseEvent","vector.fromRectSize","vector.add","vector.fromRectPos","vector.fromScroll","vector.flatMax","vector.flatMin","vector.mul","vector.map","vector.flatOr","vector.notEqual","vector.round","vector.div","vector.min","vector.sub","vector.max"],"mappings":"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"}